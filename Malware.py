import os
import getpass
import sys

def create_startup_batch(script_path=None, batch_name="run_on_startup.bat"):
    user = getpass.getuser()
    if script_path is None:
        script_path = os.path.abspath(sys.argv[0])
    python_path = sys.executable
    startup_folder = rf"C:\Users\{user}\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup"
    batch_file_path = os.path.join(startup_folder, batch_name)

    if not os.path.exists(batch_file_path):
        batch_cmd = f'start "" "{python_path}" "{script_path}"'
        with open(batch_file_path, "w") as bat_file:
            bat_file.write(batch_cmd)
        print(f"Batch file created at: {batch_file_path}")
    else:
        print(f"Batch file already exists at: {batch_file_path}")

if __name__ == "__main__":
    create_startup_batch()
    print("hi ")
